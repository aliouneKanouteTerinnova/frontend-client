<app-nav-logo></app-nav-logo>
<app-buyer-navbar></app-buyer-navbar>
<app-breadcrumb [name]="title"></app-breadcrumb>
<!-- <div class="row p-5" style="margin-top: 20px">

<app-floating-share-button></app-floating-share-button>
<div class="row p-5" style="margin-top: 20px">
  <div class="col-75">
    <div class="container">

      <form [formGroup]="checkoutForm" (submit)="checkout()">
        <div class="row">
          <div class="col-50">
            <h3 translate>checkout.billing</h3>
            <label for="fname" translate><i class="fa fa-user"></i> checkout.billing</label>
            <input type="text" id="fname" formControlName="firstname" placeholder="John M. Doe" />
            <label for="email" translate><i class="fa fa-envelope"></i> registration.register.email</label>
            <input type="text" id="email" formControlName="email" placeholder="john@example.com" />
            <label for="adr" translate><i class="fa fa-address-card-o"></i> registration.register.street</label>
            <input type="text" id="adr" formControlName="address" placeholder="542 W. 15th Street" />
            <label for="city" translate><i class="fa fa-institution"></i> registration.register.city</label>
            <input type="text" id="state" formControlName="state" placeholder="New York" />

            <div class="row">
              <div class="col-50">
                <label for="country" translate>registration.register.country</label>
                <input type="text" id="country" formControlName="country" placeholder="Etat" />
              </div>
              <div class="col-50">
                <label for="zip" translate>registration.register.zipcode</label>
                <input type="text" id="zip" formControlName="zip" placeholder="10001" />
              </div>
            </div>
          </div>

          <div class="col-50">
            <h3 translate>orders.order_details.order_payment</h3>
            <label for="fname" translate>checkout.accepted_cards</label>
            <div class="icon-container">
              <i class="fa fa-cc-visa" style="color: navy"></i>
              <i class="fa fa-cc-amex" style="color: blue"></i>
              <i class="fa fa-cc-mastercard" style="color: red"></i>
              <i class="fa fa-cc-discover" style="color: orange"></i>
            </div>
            <label for="cname" translate>checkout.total_tax</label>
            <input type="text" id="cname" formControlName="cardname" placeholder="John More Doe" disabled />
            <label for="ccnum" translate>checkout.ship_tax</label>
            <input type="text" id="ccnum" formControlName="cardnumber" placeholder="1111-2222-3333-4444" disabled />
            <label for="expmonth" translate>checkout.ship_name</label>
            <input type="text" id="expmonth" formControlName="expmonth" placeholder="September" disabled />

            <div class="row">
              <div class="col-50">
                <label for="expyear" translate>checkout.ship_method</label>
                <input type="text" id="expyear" formControlName="expyear" placeholder="2018" disabled />
              </div>
              <div class="col-50">
                <label for="cvv" translate>checkout.currency</label>
                <input type="text" id="cvv" formControlName="cvv" placeholder="352" disabled />
              </div>
            </div>
          </div>
        </div>
        <label translate>
          <input type="checkbox" checked="checked" formControlName="sameadr" /> checkout.ship_bill
        </label>
        <button class="btn" translate>checkout.checkout_button</button>
      </form>

      <div class="row" style="padding: 25px; margin: 0">

        <div class="col-100">
          <div class="container">
            <div class="mb-5 mt-5">
              <form (ngSubmit)="OnSubmit()" [formGroup]="testForm">
                <div class="card uk-card-default uk-width-*">
                  <div class="uk-card-header text-center" translate>payment.title</div>
                  <div class="uk-card-body">
                    <p class="text-danger">{{ errorMessage }}</p>

                    <input type="text" readonly id="amount" class="form-control" formControlName="amount" />
                    <input type="text" readonly id="orderNumber" class="form-control" formControlName="orderNumber" />
                    <div id="card-element" class="mt-3 mb-3"></div>
                    <div class="card-errors" role="alert"></div>
                    <button class="btn btn-dark btn-block mt-3" type="submit" translate>payment.payment_button</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div style="float: right; margin-top: -37px; position: relative; bottom: -40px; right: -35px">
            <img src="./../../../assets/img/icons/secure-payment.svg" alt="secure" style="width: 35px; height: 35px" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-25">
    <div class="container">
      <h4 translate>
        checkout.cart
        <span class="price" style="color: black">
          <i class="fa fa-shopping-cart"></i>
          <b>{{ cartData.data[0].numInCart !== 0 ? cartData.data.length : 0 }}</b>
        </span>
      </h4>
      <p *ngFor="let c of cartData.data; let i = index">
        <a href="#">{{ c.numInCart }} x {{ c.product.name }}</a>
        <span class="price">{{ formatPrice(cartService.CalculateSubTotal(i) | currency: 'EUR') }}</span>
      </p>
      <hr />
      <p translate>
        orders.order_details.order_total
        <span class="price" style="color: black"
          ><b>{{ formatPrice(cartTotal | currency: 'EUR') }}</b></span
        >
      </p>
    </div>
  </div>
</div> -->

<div class="container">
  <!-- <div class="row"> -->
  <div class="billing">
    <mat-horizontal-stepper #stepper>
      <!-- <div *ngIf="loaderService.isLoading | async" class="loader-container">
        <mat-spinner style="top: 50%; left: 50%;"></mat-spinner>
      </div> -->
      <mat-step>
        <ng-template matStepLabel>Shipping Adress</ng-template>

        <form [formGroup]="ShippingAdressForm" (ngSubmit)="addShippingAdress()">
          <div class="shipping-adress">
            <div class="address" *ngFor="let shippingAdress of shippingAdresses; let i = index">
              <ul>
                <li class="">
                  <b>{{ shippingAdress.name }}</b>
                </li>
                <li class="">{{ shippingAdress.country }}</li>
                <li class="">{{ shippingAdress.state }}</li>
                <li class="">{{ shippingAdress.city }}, {{ shippingAdress.street1 }}</li>
              </ul>

              <div class="deliver-to">
                <button matStepperNext class="btn-deliver-to">Deliver to this address</button>
              </div>

              <div class="edit-delete">
                <div class="edit">
                  <a class="btn-edit" (click)="updateShippingAdress()">Edit</a>
                </div>

                <div class="delete">
                  <a class="btn-delete" (click)="deleteShippingAdress(shippingAdress)">Delete</a>
                </div>
              </div>
            </div>
          </div>

          <hr />

          <h2>Add a new address</h2>

          <div class="row1">
            <mat-form-field appearance="outline" class="mr-4">
              <mat-label for="fullname">Full Name</mat-label>
              <input matInput type="text" id="fullname" formControlName="fullname" placeholder="Name" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label for="email">Email</mat-label>
              <input matInput type="text" id="email" formControlName="email" placeholder="Email" required />
            </mat-form-field>
          </div>

          <div class="row2">
            <mat-form-field appearance="outline" class="mr-4">
              <mat-label for="phone">Phone</mat-label>
              <input matInput type="text" id="phone" formControlName="phone" placeholder="Phone" required />
            </mat-form-field>

            <mat-form-field appearance="outline" class="mr-4">
              <mat-label for="zipcode">Zip Code</mat-label>
              <input matInput type="text" id="zipcode" formControlName="zipcode" placeholder="Zip Code" required />
            </mat-form-field>
          </div>

          <div class="row3">
            <mat-form-field appearance="outline" class="mr-4">
              <mat-label for="country">Country</mat-label>
              <input matInput type="text" id="country" formControlName="country" placeholder="Country" required />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label for="state">State</mat-label>
              <input matInput type="text" id="state" formControlName="state" placeholder="State" required />
            </mat-form-field>
          </div>
          <div class="row4">
            <mat-form-field appearance="outline" class="mr-4">
              <mat-label for="city">City</mat-label>
              <input matInput type="text" id="city" formControlName="city" placeholder="City" required />
            </mat-form-field>

            <mat-form-field appearance="outline" class="mr-4">
              <mat-label for="street">Street</mat-label>
              <input matInput type="text" id="street" formControlName="street" placeholder="Street" required />
            </mat-form-field>
          </div>

          <div class="row5">
            <section>
              <p><mat-checkbox formControlName="use-default">Use as my default address.</mat-checkbox></p>
            </section>
          </div>

          <div>
            <button matStepperNext mat-button>Use this adress â®ž</button>
          </div>
        </form>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Articles</ng-template>

        <h2>Choose the delivery address for each item</h2>

        <p>
          Did you forget an address?
          <button class="prev_step" matStepperPrevious><a>Enter a new shipping address</a></button>
        </p>
        <!-- {{ f.value | json }} -->
        <div class="article-header">
          <div class="article"><b>Articles</b></div>
          <!-- <div class="qte"><b>Qte</b></div> -->
          <div class="shipadress"><b>Shipping Adress</b></div>
        </div>

        <hr />

        <form [formGroup]="setShipAdressForm" (ngSubmit)="createShipment()">
          <div class="productrow" *ngFor="let c of cartData.data; let i = index">
            <div class="product">
              <div class="img-product">
                <img height="100" width="100" src="{{ c.product.images[0].file }}" alt="" />
              </div>
              <div class="info">
                <h4>
                  <b>{{ c.product.name }}</b>
                </h4>
                <p class="price">{{ c.product.price | currency: 'EUR' }}</p>
                <p>{{ c.product.description | slice: 0:30 }} ...</p>
                <a href="#">Delete</a>
              </div>
            </div>

            <!-- <div class="incdecqte">
              <mat-form-field>
                <input
                  placeholder="Change quantity"
                  matInput
                  id="qte"
                  type="number"
                  [value]="c.numInCart"
                  [max]="c.product.quantity"
                  [min]="1"
                />
              </mat-form-field>
            </div> -->

            <div class="selectadressship">
              <!-- <mat-form-field> -->
              <select
                (change)="updateCartItems($event)"
                formControlName="ship_adress"
                [(value)]="adressDefault"
                [(ngModel)]="adressDefault"
              >
                <!-- <option value="product,{{ c.product.id }},ship_adress,{{ a.id }}" selected="selected">
                {{ a.name }}, {{ a.city }}
              </option> -->
                <option
                  *ngFor="let a of shippingAdresses"
                  value="product,{{ c.product.id }},ship_adress,{{ a.id }}"
                  placeholder="Change shipping adress"
                >
                  {{ a.name }}, {{ a.city }}
                </option>
              </select>
              <!-- </mat-form-field> -->
            </div>
          </div>

          <div>
            <button class="mr-4" matStepperPrevious mat-button>â®œ Back</button>
            <button matStepperNext mat-button>Got Shipping Method â®ž</button>
          </div>
        </form>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Shipping</ng-template>

        <h2>Choose a shipping method for all products</h2>

        <form [formGroup]="setRates" (ngSubmit)="updateOrderItems()">
          <div class="article-header">
            <div class="article"><b>Articles</b></div>
            <div class="shipmethod"><b>Shipping Method</b></div>
          </div>

          <hr />

          <div class="productrow" *ngFor="let c of cartData.data; let i = index">
            <div class="product">
              <div class="img-product">
                <img height="100" width="100" src="{{ c.product.images[0].file }}" alt="" />
              </div>
              <div class="info">
                <h4>
                  <b>{{ c.product.name }}</b>
                </h4>
                <p class="price">{{ c.product.price | currency: 'EUR' }}</p>
                <p>{{ c.product.description | slice: 0:30 }} ...</p>
                <a href="#">Delete</a>
              </div>
            </div>

            <div class="selectshipmethod">
              <!-- <mat-form-field> -->
              <select (change)="updateShipmentMethod($event)" [(value)]="selected" formControlName="_rates">
                <option
                  *ngFor="let r of rates; let i = index"
                  value="object_id,{{ r.object_id }}"
                  placeholder="Choose shipping method"
                >
                  provider: {{ r.provider }} -- price: â‚¬{{ r.amount }}
                </option>
              </select>
              <!-- </mat-form-field> -->
            </div>
          </div>

          <div>
            <button class="mr-4" mat-button matStepperPrevious>â®œ Back</button>
            <button mat-button matStepperNext>Got To Payment Method â®ž</button>
          </div>
        </form>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Choose Payment Method</ng-template>

        <div>
          <h2>Select a payment method</h2>

          <div class="paymentMethods">
            <form #p="ngForm" (ngSubmit)="choosePaymentMethod(p)">
              <mat-card class="col-12 mt-5">
                <mat-card-title-group> <mat-card-title>Payments Methods</mat-card-title> </mat-card-title-group><br />
                <mat-card-content>
                  <mat-radio-group ngModel name="payment_method" class="example-radio-group">
                    <!-- <div class="mt-4">
                      <h4><b>Bank accounts</b></h4>
                    </div> -->

                    <mat-radio-button value="paymentMethod,iban">
                      Bank account
                      <!-- <a class="ml-5" routerLink="#" (click)="deleteBankAcc(acc.id)">Delete</a> -->
                    </mat-radio-button>

                    <!-- <div class="mt-4">
                      <h4><b>Credit Cards accounts</b></h4>
                    </div> -->

                    <mat-radio-button value="paymentMethod,card" class="mt-2">
                      Credit Card
                      <!-- <a class="ml-5" routerLink="#" (click)="deleteCreditCard(credit.id)">Delete</a> -->
                    </mat-radio-button>

                    <!-- <div class="mt-4">
                      <h4><b>Others payment methods</b></h4>
                    </div> -->

                    <mat-radio-button value="paymentMethod,paypal">
                      <div><img src="../../../assets/img/icons/logo-Paypal.jpg" height="40" width="90" /></div>
                    </mat-radio-button>
                  </mat-radio-group>
                </mat-card-content>
              </mat-card>

              <!-- <mat-radio-group>
                  <mat-radio-button  *ngFor="let credit of creditCards" [value]="credit.id">
                    {{credit.card_name}}
                  </mat-radio-button>
                </mat-radio-group> -->
            </form>
          </div>

          <hr />
          <!--
          <mat-accordion>
            <mat-expansion-panel class="mb-4">
              <mat-expansion-panel-header>
                <mat-panel-title> Add a bank account </mat-panel-title>
              </mat-expansion-panel-header>

              <div class="bank">
                <form #b="ngForm" (ngSubmit)="addBankAcc(b)">
                  <div class="row1">
                    <h2>Add a current account</h2>

                    <mat-form-field appearance="outline" class="mr-4">
                      <mat-label for="bic">BIC (Swift-Code)</mat-label>
                      <input matInput type="text" id="bic" ngModel name="bic" required />
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="mr-4">
                      <mat-label for="iban">IBAN</mat-label>
                      <input matInput type="text" id="iban" ngModel name="iban" required />
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label for="account_name">Account holder name</mat-label>
                      <input matInput type="text" id="account_name" ngModel name="account_name" required />
                    </mat-form-field>
                  </div>

                  <div class="row4">
                    <section>
                      <p>
                        <mat-checkbox ngModel name="default_payment">Set as my default payment method.</mat-checkbox>
                      </p>
                    </section>
                  </div>

                  <div>
                    <button class="payBtn mt-3" type="submit" translate>Add bank account</button>
                  </div>
                </form>

                <div>
                  <div></div>
                </div>
              </div>
            </mat-expansion-panel>

            <mat-expansion-panel class="mb-4">
              <mat-expansion-panel-header>
                <mat-panel-title> Add a credit card </mat-panel-title>
              </mat-expansion-panel-header>

              <div class="credit-card">
                <form #c="ngForm" (ngSubmit)="addCreditCard(c)">
                  <div class="row1">
                    <h2>Add a credit card</h2>

                    <mat-form-field appearance="outline" class="mr-4">
                      <mat-label for="card_number">Card Number</mat-label>
                      <input matInput type="text" id="card_number" ngModel name="card_number" required />
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label for="name_on_card">Name on card</mat-label>
                      <input matInput type="text" id="name_on_card" ngModel name="name_on_card" required />
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label for="cvc">CVC</mat-label>
                      <input matInput type="number" id="cvc" ngModel name="cvc" required />
                    </mat-form-field>
                  </div>

                  <div>
                    <mat-form-field appearance="outline" class="mr-4">
                      <mat-select id="expireMM" ngModel name="expireMM">
                        <mat-option value="">Month</mat-option>
                        <mat-option value="01">January</mat-option>
                        <mat-option value="02">February</mat-option>
                        <mat-option value="03">March</mat-option>
                        <mat-option value="04">April</mat-option>
                        <mat-option value="05">May</mat-option>
                        <mat-option value="06">June</mat-option>
                        <mat-option value="07">July</mat-option>
                        <mat-option value="08">August</mat-option>
                        <mat-option value="09">September</mat-option>
                        <mat-option value="10">October</mat-option>
                        <mat-option value="11">November</mat-option>
                        <mat-option value="12">December</mat-option>
                      </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-select id="expireYY" ngModel name="expireYY">
                        <mat-option value="">Year</mat-option>
                        <mat-option value="2021">2021</mat-option>
                        <mat-option value="2022">2022</mat-option>
                        <mat-option value="2023">2023</mat-option>
                        <mat-option value="2024">2024</mat-option>
                        <mat-option value="2025">2025</mat-option>
                        <mat-option value="2026">2026</mat-option>
                        <mat-option value="2027">2027</mat-option>
                        <mat-option value="2028">2028</mat-option>
                        <mat-option value="2029">2029</mat-option>
                        <mat-option value="2030">2030</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div class="row4">
                    <section>
                      <p>
                        <mat-checkbox formControlName="same_adress">Set as my default payment method.</mat-checkbox>
                      </p>
                    </section>
                  </div>

                  <div>
                    <button class="payBtn mt-3" type="submit" translate>Add card</button>
                  </div>
                </form>

                <div>
                  <div><img src="../../../assets/img/credit-card.png" alt="" /></div>
                </div>
              </div>
            </mat-expansion-panel>

            <mat-expansion-panel class="mb-4">
              <mat-expansion-panel-header>
                <mat-panel-title> Other payment methods </mat-panel-title>
              </mat-expansion-panel-header>
              <div>
                mat
              </div>

            </mat-expansion-panel>
          </mat-accordion> -->
        </div>

        <div>
          <button class="mr-4" mat-button matStepperPrevious>â®œ Back</button>
          <button mat-button matStepperNext (click)="choosePaymentMethod(p); place_order = true">Review â®ž</button>
        </div>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Review and payment</ng-template>

        <div class="card-div mb-4 mt-2" *ngIf="is_card">
          <form id="payment-form" (ngSubmit)="onSubmit()" [formGroup]="testForm">
            <h3 style="text-align: center; font: bold, 16px, Raleway">Credit Card Payment</h3>

            <div id="card-element"><!--Stripe.js injects the Card Element--></div>

            <button id="submit" type="submit" class="payBtn">
              <div class="spinner hidden" id="spinner"></div>

              <span id="button-text" (click)="(loading)">Pay now</span>
            </button>

            <p id="card-error" role="alert"></p>

            <p class="result-message hidden"></p>
          </form>
        </div>

        <div class="iban-div mb-4 mt-2" *ngIf="is_bank">
          <form id="payment-form" (ngSubmit)="sepaSubmit()" [formGroup]="ibanForm">
            <h3 style="text-align: center; font: bold, 16px, Raleway">Bank Account Payment</h3>

            <label for="name"> Name </label>
            <input id="name" type="text" formControlName="name" placeholder="John Doe" required />

            <label for="email"> Email Address </label>
            <input id="email" type="email" formControlName="email" placeholder="john.doe@email.com" required />

            <label for="iban-element"> IBAN </label>
            <div id="iban-element">
              <!-- A Stripe Element will be inserted here. -->
            </div>

            <button id="iban-submit" type="submit" class="payBtn mt-4">
              <div class="spinner hidden" id="spinner"></div>

              <span id="button-text">Pay now</span>
            </button>

            <!-- Display mandate acceptance text. -->
            <div id="mandate-acceptance">
              By providing your payment information and confirming this payment, you authorise (A)
              <strong>INSERT YOUR BUSINESS NAME HERE</strong> and Stripe, our payment service provider and/or PPRO, its
              local service provider, to send instructions to your bank to debit your account and (B) your bank to debit
              your account in accordance with those instructions. As part of your rights, you are entitled to a refund
              from your bank under the terms and conditions of your agreement with your bank. A refund must be claimed
              within 8 weeks starting from the date on which your account was debited. Your rights are explained in a
              statement that you can obtain from your bank. You agree to receive notifications for future debits up to 2
              days before they occur.
            </div>

            <!-- Used to display form errors. -->
            <div id="error-message" role="alert"></div>
          </form>
        </div>

        <div class="uk-container mb-4 mt-2" *ngIf="is_paypal">
          <p class="text-danger">{{ errorMessage }}</p>
          <div id="paypal"></div>
        </div>

        <div class="productrow" *ngFor="let c of cartData.data; let i = index">
          <div class="product">
            <div class="img-product">
              <img height="100" width="100" src="{{ c.product.images[0].file }}" alt="" />
            </div>
            <div class="info">
              <h4>
                <b>{{ c.product.name }}</b>
              </h4>
              <p class="price">{{ c.product.price | currency: 'EUR' }}</p>
              <p>{{ c.product.description | slice: 0:30 }} ...</p>
              <p>Quantity: {{ c.numInCart }}</p>
            </div>
          </div>
          <br />

          <div class="selectshipmethod">
            <!-- <mat-form-field> -->
            <!-- <a routerLink="#"></a> -->
            <!-- </mat-form-field> -->
          </div>
        </div>

        <div>
          <button class="mr-4" mat-button matStepperPrevious>â®œ Back</button>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </div>

  <div class="col-25">
    <div class="summary">
      <div class="total">
        <h6 class="title">Summary</h6>

        <div class="subtotal">
          <div class="subtotal1">
            <span>Items Price :</span>
            <span class="devic">{{ formatPrice(cartTotal | currency: 'EUR') }}</span>
          </div>

          <div class="taxe">
            <span>Taxe :</span>

            <span class="devic">{{ formatPrice(totalTax | currency: 'EUR') }}</span>
          </div>

          <hr />

          <div class="subtotal1">
            <span translate>Posting & pakaging :</span>
            <span class="devic">{{ formatPrice(cartTotal | currency: 'EUR') }}</span>
          </div>
        </div>

        <div class="checkouBtn">
          <button
            routerLink="to_pay"
            matButton
            (click)="initPayment(); _pay()"
            [disabled]="!place_order"
            routerLink="#"
          >
            Place Order
          </button>
        </div>

        <div class="text-order">
          <span>By placing an order, you agree to Vaanah <a routerLink="#">terms and conditions.</a></span>
        </div>
      </div>
    </div>
  </div>
  <!-- </div> -->
</div>
<app-footer></app-footer>
